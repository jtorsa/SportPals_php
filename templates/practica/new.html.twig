{% extends 'base.html.twig' %}

{% block title %}New Practica{% endblock %}

{% block body %}
    <h1>Create new Practica</h1>

     <form name="practica" id="practica_form" method="post" action="{{ path('practica_new_ajax') }}">
        {% for deporte in global.deportes %}
            <h3>{{deporte.nombre}}</h3>
            <label>Nivel</label>
            <select name="{{deporte.nombre}}_nivel" id="{{deporte.nombre}}_nivel">
             <option selected> </option>
            {% set find = false %}
            {% set try = '' %}
            {% set name = '' %}
                {% for nivel in deporte.niveles %}
                {% set find = false %} 
                {% set  try = deporte.id~'_'~nivel.id %}
                {% set name = nivel.nivel %}
                    {% for nivelo in global.practicados.niveles %}
                    {% set  try = deporte.id~'_'~nivel.id %}
                       {% if nivelo == try %}
                            {% set find = true %}
                        {% endif %}
                    {% endfor %}
                     {% if find == true %}
                        <option value="{{try}}" selected> {{name}}</option>
                    {% else %}
                        <option value="{{try}}"> {{name}}</option>
                    {% endif %}
                {% endfor %}
                </select>
                <label>Posicion</label>
            <select name="{{deporte.nombre}}_posicion" id="{{deporte.nombre}}_posicion">
             <option selected></option>
                {% for posicion in deporte.posiciones %}
                {% set find = false %} 
                {% set name = posicion.nombre %}
                {% set  try = deporte.id~'_'~posicion.id %}
                    {% for pos in global.practicados.posiciones %}
                       {% if pos == try %}
                            {% set find = true %}
                        {% endif %}
                    {% endfor %}
                     {% if find == true %}
                        <option value="{{try}}" selected> {{name}}</option>
                    {% else %}
                        <option value="{{try}}"> {{name}}</option>
                    {% endif %}
                {% endfor %}
                </select>
        {% endfor %}
        <button id="actualizar" class="btn" >Actualizar</button>
    </form>
    <script>

    $(document).ready(function() {
        var form = $('#practica_form');
        var url = form.attr('action');
        var method = form.attr('method');
        
        $('button').click(function(event){
            event.preventDefault();
            
            console.log(form);
            $.ajax({
                url : url,
                type: method,
                data: form.serialize(),
                success: function(html){
                    location.reload();
                }
            });
            });
        });
    })
</script>
{% endblock %}
